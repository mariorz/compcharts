{"version":3,"sources":["lpdashboard/coingecko.cljs"],"mappings":"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","names":["lpdashboard.coingecko/<token-prices","addresses","c__38841__auto__","cljs.core.async.chan","cljs.core.async.impl.dispatch/run","f__38842__auto__","switch__38749__auto__","state_53882","state_val_53883","inst_53862","inst_53861","inst_53858","inst_53859","inst_53860","inst_53863","inst_53864","inst_53865","cljs.core/PersistentHashMap","inst_53866","statearr-53884","cljs.core.async.impl.ioc-helpers/take!","inst_53868","inst_53869","inst_53870","p1__53855#","inst_53871","inst_53872","p1__53856#","inst_53873","inst_53874","inst_53875","inst_53876","inst_53877","p1__53857#","inst_53878","inst_53879","inst_53880","cljs.core.async.impl.ioc-helpers/return-chan","statearr-53885","state-machine__38750__auto__","ret-value__38751__auto__","result__38752__auto__","cljs.core/keyword-identical?","ex__38753__auto__","e53886","statearr-53887","cljs.core/seq","statearr-53888","cljs.core/first","state__38843__auto__","statearr-53889","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","base-url","addy-args","goog.string/urlEncode","cljs.core.apply","cljs.core/str","clojure.string.join","full-url","data","cljs_http.client.get","data-sans-ts","lpdashboard.utils/update-values","cljs.core.dissoc","data'","cljs.core.merge_with","n","js/module$node_modules$bignumber_DOT_js$bignumber","cljs.core/zipmap","cljs.core.map","cljs.core/name","cljs.core/keys","clojure.set/rename-keys","cljs.core/vals","lpdashboard.coingecko/<historic-token-prices","address","state_53902","state_val_53903","inst_53891","inst_53892","inst_53893","inst_53894","inst_53895","inst_53896","statearr-53904","inst_53898","inst_53899","inst_53900","statearr-53905","e53906","statearr-53907","statearr-53908","statearr-53909","cljs.core.println"],"sourcesContent":["(ns lpdashboard.coingecko\n  (:require [cljs.core.async :refer [go]]\n            [cljs.core.async.interop :refer-macros [<p!]]\n            [cljs-http.client :as http]\n            [bignumber.js :as BigNumber]\n            [bignumber.core]\n            [goog.string :as string]\n            [goog.uri.utils :as uri]\n            [lpdashboard.utils :as u]))\n\n\n(defn <token-prices\n  [addresses]\n  (go (let [base-url (str \"https://api.coingecko.com/\"\n                          \"api/v3/simple/token_price/ethereum?\"\n                          \"vs_currencies=usd%2Ceth&include_last_updated_at=true\"\n                          \"&contract_addresses=\")\n            addy-args (string/urlEncode\n                       (apply str (clojure.string-join \",\" addresses)))\n            full-url (str base-url addy-args)\n            data (:body\n                  (<! (http/get\n                       full-url\n                       {:with-credentials? false})))\n            data-sans-ts (u/update-values\n                          data\n                          #(dissoc % :last_updated_at))\n            data' (merge-with data\n                              (u/update-values\n                               data-sans-ts\n                               #(u/update-values % (fn [n] (BigNumber. (str n))))))]\n        (zipmap\n         (map name (keys data'))\n         (map #(clojure.set/rename-keys % {:last_updated_at :ts\n                                           :usd \"usd\"\n                                           :eth \"eth\"})\n              (vals data'))))))\n\n\n(defn <historic-token-prices\n  [address]\n  (go (let [base-url (str \"https://api.coingecko.com/\"\n                          \"api/v3/coins/ethereum/contract/\"\n                          address\n                          \"/market_chart/?vs_currency=usd&days=700\")\n            full-url base-url\n            - (println full-url)\n            data (:prices (:body\n                  (<! (http/get\n                       full-url\n                       {:with-credentials? false}))))]\n        data\n        #_(zipmap\n         (map name (keys data'))\n         (map #(clojure.set/rename-keys % {:last_updated_at :ts\n                                           :usd \"usd\"\n                                           :eth \"eth\"})\n              (vals data'))))))\n\n\n#_(go (def token-prices (<! (<coingecko-token-prices token-ids))))\n\n"]}